function numberJump(e, t, o, n) {
    e.prop("number", o).animateNumber({number: t}, n)
}

function PrefixInteger(e, t) {
    return (Array(t).join("0") + e).slice(-t)
}

function flipNum(e, t) {
    $(".packbox .list b").text("");
    e = PrefixInteger(e, t);
    for (var o = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], n = "", a = String(e).length, s = e.toString(), i = ($(".packbox"), 0); i < o.length; i++) n += "<strong>" + o[i] + "</strong>";
    $(".banner .packbox .list").html(n), $(".centbuy .packbox .list").html(n), $(".footbuy .packbox .list").html(n);
    for (var r = 0; r <= a; r++) {
        var c = s.substring(r, r + 1);
        $(".banner .packbox .list").eq(r).animate({marginTop: 34 * -c}, "slow"), $(".centbuy .packbox .list").eq(r).animate({marginTop: 34 * -c}, "slow"), $(".footbuy .packbox .list").eq(r).animate({marginTop: 34 * -c}, "slow")
    }
}

function reduceNum(e, t) {
  $(".progressbar span").append('<em class="reduce"></em>');
  var o = 2.31 * e;
  $(".progressbar span").css("width", o),
      setTimeout('$(".progressbar .reduce").addClass("zoomout");', 100),
      setTimeout('$(".progressbar .reduce").remove();', getReTime()), 1 == t && setTimeout(function () {
    flipNum(e, 2)
  })
}

function maskShow() {
    $(".mask").remove(), $(".mask-box").remove();
    $.getUrlParam("aff");
    $(".main").append('<div class="mask"></div><div class="mask-box"><h2>BLACK FRIDAY SURPRISE</h2><div class="clearfix"><div class="fl left"><img src="' + imgSrc + '" alt="Advanced SystemCare 12 Pro"/></div><div class="price fl"><h3>Geen zorgen! Toch nog een mooie prijs voor u:</h3><p><strong>€<big>16</big>,99</strong> <b>1 jaar / 3 pc’s</b></p><a class="buybtn" href="' + _href + '" onclick="' + _ga + '"><i class="all-icons"></i><span>Activeer Nu</span></a><p class="year">Pak deze laatste kans op een goede Black Friday deal</p></div></div></div>'), $(".mask").addClass("started"), $(".mask-box").addClass("slipUp"), $(".mask").hasClass("started") && $(".mask-box .close").on("click", function () {
        $(".mask").remove(), $(".mask-box").remove()
    })
}

function cSet(e, t) {
    var o = new Date;
    o.setTime(o.getTime() + 1728e5), document.cookie = e + "=" + escape(t) + ";expires=" + o.toGMTString()
}

function cGet(name) {
  var exp = new Date();
  name = name + exp.getDate();
  var arr, reg = new RegExp("(^| )" + name + "=([^;]*)(;|$)");
  if (arr = document.cookie.match(reg))
    return unescape(arr[2]);
  else
    return null;
}

$.fn.scrollWindow = function (e, t, o) {
    $(window).on("scroll", function () {
        $(window).scrollTop() > e.offset().top ? t.addClass(o) : t.removeClass(o)
    })
}, $.fn.target = function (e, t) {
    $(this).click(function () {
        t || (t = 0);
        var o = e.offset().top - t;
        $("html, body").animate({scrollTop: o}, "slow")
    })
}, jQuery.getUrlParam = function (e) {
    var t = new RegExp("(^|&)" + e + "=([^&]*)(&|$)"), o = window.location.search.substr(1).match(t);
    return null != o ? unescape(o[2]) : ""
}, $(function () {
    $("#dg-container").gallery(), $(window).scrollWindow($(".banner .buybtn"), $(".backtotop"), "on"), $(window).on("scroll", function () {
        var e = $(window).scrollTop();
        $(".footbuy").offset().top;
        e >= $(".review").offset().top ? ($(".footbuy").addClass("on"), $(".bottom").addClass("on")) : ($(".footbuy").removeClass("on"), $(".bottom").removeClass("on"))
    })
});

function packsInit() {
  packs = 99;
  getSales();
}

function getSales() {
  var date = new Date();
  $.ajax({
    type: "GET",
    url: "basc.php",
    data: "action=getPacks&d=" + date.getDate(),
    success: function (res) {
      var sales = JSON.parse(res);
      if (sales.packsNum != packs) {
        packs = sales.packsNum;
        reduceNum(packs, 1);
      }
      if (packs > 0) {
        $(window).unload(function () {
          packs = cGet('ascblacknl_p');
        });
        setTimeout('getSales()', getReTime());
      }else{
        maskShow();
      }
    }
  });
}

function getReTime() {
  var packsNumTotal = cGet('ascblacknl_t');
  if((packsNumTotal - packs) < 5){
    retime = 2;
  }else{
    if (packsNumTotal >= 88 && packsNumTotal < 94) {
      retime = (Math.random() > 0.5) ? 7.5 : 9.5;
    }else{
      retime = (Math.random() > 0.5) ? 7 : 9;
    }
  }
  return retime * 1000;
}

function getViewNum() {
    $.ajax({
        type: "GET", url: "basc.php", data: "action=getViewNum", success: function (e) {
            $(".viewNum").html(e)
        }
    }), setTimeout("getViewNum()", 15e3)
}

$(function () {
    $("#dg-container").gallery(), $(window).scrollWindow($(".banner .buybtn"), $(".backtotop"), "on"), $("#backtotop").target($(".banner"), 0), numberJump($(".viewNum"), viewNum, 500, 1500)
}), $(function () {
        packsInit(),
        setTimeout("getViewNum()", 15e3)
});
$(function () {
    //benefits
    $(".benefits .detail-list dl").hover(function () {
        $(".benefits .showcase .screenshot").css('marginLeft', -555 * ($(this).index() + 1));
        $(".benefits .zoom li").removeClass('active').eq($(this).index() + 1).addClass('active');
        $(this).addClass("active").siblings().removeClass("active");
        $(".benefits .list-icon li").removeClass('active').eq($(this).index() + 1).addClass('active');
    });
    $(".benefits .list-icon li").hover(function () {
        $(".benefits .showcase .screenshot").css('marginLeft', -555 * ($(this).index()));
        $(".benefits .zoom li").removeClass('active').eq($(this).index()).addClass('active');
        var num = $(this).index();
        if (num == 0) {

            $(".benefits .detail-list dl").removeClass("active");
        } else {
            $(".benefits .detail-list dl").eq($(this).index() - 1).addClass("active").siblings().removeClass("active");
        }
        $(".benefits .list-icon li").removeClass('active');
        $(this).addClass('active');
    });
});