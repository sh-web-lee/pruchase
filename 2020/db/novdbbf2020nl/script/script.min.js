function numberJump(e, t, o, n) {
    e.prop("number", o).animateNumber({number: t}, n)
}

function PrefixInteger(e, t) {
    return (Array(t).join("0") + e).slice(-t)
}

function flipNum(e, t) {
    $(".packbox .list b").text("");
    e = PrefixInteger(e, t);
    $(".activeNum").text(e)
    for (var o = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], n = "", a = String(e).length, s = e.toString(), i = ($(".packbox"), 0); i < o.length; i++)  n += "<strong>" + o[i] + "</strong>"; 

   
    $(".banner .packbox .list").html(n), $(".centbuy .packbox .list").html(n);
   
    for (var r = 0; r <= a; r++) {
        var c = s.substring(r, r + 1);
        $(".banner .packbox .list").eq(r).animate({marginTop: 34 * -c}, "slow"), $(".centbuy .packbox .list").eq(r).animate({marginTop: 34 * -c}, "slow")
    }
   
}

function reduceNum(e, t) {
    $(".progressbar span").append('<em class="reduce"></em>');
    var o = 2.31 * e;
    $(".progressbar span").css("width", o),
    setTimeout('$(".progressbar .reduce").addClass("zoomout");', 100),
    setTimeout('$(".progressbar .reduce").remove();', getReTime()),
    1 == t && setTimeout(function () {flipNum(e, 2)})
}

function maskShow() {
    $(".mask").remove(), $(".mask-box").remove();
    $.getUrlParam("aff");
    $(".main").append('<div class="mask"></div><div class="mask-box"><h2>Oops! Black  Friday Sale Has Ended!</h2><div class="clearfix"><div class="fl left"><img src="' + imgSrc + '" alt="Driver Booster 6 Pro"/></div><div class="price fl"><img src="' + imgOff + '" alt="70% OFF"/><p><strong>€<big>22</big>,95</strong> <b><del>€74,85</del></b></p><a class="buybtn" href="' + _href + '" onclick="' + _ga + '"><i class="all-icons"></i><span>Activeer Nu</span></a></div></div></div>'), $(".mask").addClass("started"), $(".mask-box").addClass("slipUp"), $(".mask").hasClass("started") && $(".mask-box .close").on("click", function () {
        $(".mask").remove(), $(".mask-box").remove()
    })
}

function cSet(e, t) {
    var o = new Date;
    o.setTime(o.getTime() + 1728e5), document.cookie = e + "=" + escape(t) + ";expires=" + o.toGMTString()
}
function cGet(name) {
    var exp = new Date();
    name = name + exp.getDate();
    var arr, reg = new RegExp("(^| )" + name + "=([^;]*)(;|$)");
    if (arr = document.cookie.match(reg))
        return unescape(arr[2]);
    else
        return null;
}


$.fn.scrollWindow = function (e, t, o) {
    $(window).on("scroll", function () {
        $(window).scrollTop() > e.offset().top ? t.addClass(o) : t.removeClass(o)
    })
}, $.fn.target = function (e, t) {
    $(this).click(function () {
        t || (t = 0);
        var o = e.offset().top - t;
        $("html, body").animate({scrollTop: o}, "slow")
    })
}, jQuery.getUrlParam = function (e) {
    var t = new RegExp("(^|&)" + e + "=([^&]*)(&|$)"),
        o = window.location.search.substr(1).match(t);
    return null != o ? unescape(o[2]) : ""
}, $(function () {
    $("#dg-container").gallery(),
        $(window).scrollWindow($(".banner .buybtn"),
            $(".backtotop"), "on"),
        $(window).on("scroll", function () {
            var e = $(window).scrollTop();
            $(".footbuy").offset().top;
            e >= $(".review").offset().top ? ($(".footbuy").addClass("on"), $(".bottom").addClass("on")) : ($(".footbuy").removeClass("on"), $(".bottom").removeClass("on"))
        })
});

function packsInit() {
    packs = 99;
    getSales();
}

function getSales() {
    var date = new Date();
    $.ajax({
        type: "GET",
        url: "bdb.php",
        data: "action=getPacks&d=" + date.getDate(),
        success: function (res) {
            var sales = JSON.parse(res);
            if (sales.packsNum != packs) {
                packs = sales.packsNum;
                reduceNum(packs, 1);
            }
            if (packs > 0) {
                $(window).unload(function () {
                    packs = cGet('dbblacknl_p');
                });
                setTimeout('getSales()', getReTime());
            }else{
                maskShow();
            }
        }
    });
}

function getReTime() {
    var packsNumTotal = cGet('dbblacknl_t');
    if((packsNumTotal - packs) < 5){
        retime = 2;
    }else{
        if (packsNumTotal >= 85 && packsNumTotal < 94) {
            retime = (Math.random() > 0.5) ? 7.5 : 9.5;
        }else{
            retime = (Math.random() > 0.5) ? 7 : 9;
        }
    }
    return retime * 1000;
}

function getViewNum() {
    $.ajax({
        type: "GET", url: "bdb.php", data: "action=getViewNum", success: function (e) {
            $(".viewNum").html(e)
        }
    }), setTimeout("getViewNum()", 15e3)
}

//feature
$(window).on('scroll', function() {　
    if ($(document).scrollTop() > $(".feature").offset().top -200) {
      $(".feature dl").addClass("on");
    }
  });
  //intro
  $(".intro .right-message dl").hover(function () {
    var index = $(this).index();
    $(".intro .right-message>span").stop().animate({marginTop: index*105}, 500);
    $(".intro .left-message ul li").eq(index).addClass("on").siblings().removeClass("on");
  });

$(function () {
    $("#dg-container").gallery(), $(window).scrollWindow($(".banner .buybtn"), $(".backtotop"), "on"), $("#backtotop").target($(".banner"), 0), numberJump($(".viewNum"), viewNum, 500, 1500), $(window).on("scroll", function () {
        $(window).scrollTop() > $(".intro").offset().top && ($(".together .asc-box").removeClass("on").addClass("on"), $(".together .db-box").removeClass("on").addClass("on"))
    })
}), $(function () {
    packsInit(),
    setTimeout("getViewNum()", 15e3)
});